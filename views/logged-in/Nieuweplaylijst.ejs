<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google" content="notranslate">
    <title>Bsharp</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="css/MainStyle.css" rel="stylesheet">
    <link href="css/NavMail.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.3/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="/resources/demos/style.css">
    <link href="css/MainStyle.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://code.jquery.com/ui/1.13.3/jquery-ui.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css">    
    <script src="https://code.jquery.com/ui/1.13.3/jquery-ui.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.15/css/bootstrap-multiselect.css">

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.15/js/bootstrap-multiselect.min.js"></script>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="st/theme.css">

    <style>
        #sortable {
            list-style-type: none;
            margin: 0;
            padding: 0;
            width: 60%;
        }

        #sortable li {
            margin: 0 3px 3px 3px;
            padding: 0.4em;
            padding-left: 1.5em;
            font-size: 1.4em;
            height: 18px;
        }

        #sortable li span {
            position: absolute;
            margin-left: -1.3em;
        }

        #draggable {
            width: 350px;
            height: 500px;
            padding: 0.5em;
            float: left;
            margin: 10px 10px 10px 0;
        }

        #droppable {
            width: 350px;
            height: 500px;
            padding: 0.5em;
            float: left;
            margin: 10px;
        }

        /* Add this CSS rule to change the text color of the select box */
       .myChoices {
    color: burlywood;
    font-family: "Kalam", cursive;
    font-weight: 700;
    font-style: normal;
    padding: 0.5%;
    padding-right: 8%;
    padding-left: 8%;
    background-image: url('/images/baking3.jpg');
    background-size: auto;
    background-position: center;
    color: burlywood;
}

    .myChoices option:checked {
        color: burlywood;
        font-family: "Kalam", cursive;
        font-weight: 700;
        font-style: normal;
        padding: 0.5%;
        padding-right: 8%;
        padding-left: 8%;
        background-image: url('/images/baking3.jpg');
        background-size: auto;
        background-position: center;
        color: burlywood;
    }

  .choices__list--multiple .choices__item--selectable {
     color: burlywood;
    font-family: "Kalam", cursive;
    font-weight: 700;
    font-style: normal;
    width: 100%;
    padding: 0.5%;
    padding-right: 8%;
    padding-left: 8%;
    background-image: url('/images/baking3.jpg');
    background-size: auto;
    background-position: center;
    color: burlywood;
  }

  /* Style for selectable values in the dropdown */
  .choices__list--dropdown .choices__item--selectable {
    color: burlywood;
    font-family: "Kalam", cursive;
    font-weight: 700;
    font-style: normal;
    padding: 0.5%;
    padding-right: 8%;
    padding-left: 8%;
    background-image: url('/images/baking3.jpg');
    background-size: auto;
    background-position: center;
    color: burlywood;
  }

    </style>
</head>

<body>
	<a href="https://github.com/SortableJS/Sortable"><img style="position: fixed; top: 0; right: 0; border: 0; z-index:99999" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>


	<div id="example1" class="list-group">
		<div class="list-group-item">Item 1</div>
		<div class="list-group-item">Item 2</div>
		<div class="list-group-item">Item 3</div>
		<div class="list-group-item">Item 4</div>
		<div class="list-group-item">Item 5</div>
		<div class="list-group-item">Item 6</div><select class="myChoices" id="mySelect" multiple="multiple" name="lijst_nummernaam" style="background-color: grey; color: black; width: 220px; height: 400px; overflow-x: hidden; overflow-y: auto">
                    <% for (let nummer of nummers) { %>
                        <option value="<%= nummer.nr_naam %>" style="background-color: grey; color: black;" >
                            <%= nummer.nr_naam %>
                        </option>
                            <%= nummer.nr_naam %></option>
                    <% } %>
                </select>
	</div>
    <nav class="nav">
        <%- include('./NavMenuLoggedin.ejs') %>
    </nav>
    <%- include('./menuHome.ejs') %>
    <br><br>
    <h1 class="container6">Nieuwe afspeellijst:</h1>
    <form class="column-item" id="myForm" method="post" action="/save-values">
        <div class="column">
            <div>
                <label for="lijst_naam">Lijst naam:</label>
                <input type="text" id="lijst_naam" name="lijst_naam"> <br>
                <label for="lijst_aantal">Aantal keren gespeeld:</label>
                <input type="number" id="lijst_aantal" name="lijst_aantal"> <br>
                <label for="lijst_type">Type:</label>
                <input type="text" id="lijst_type" name="lijst_type" list="type_suggestions">
                <datalist id="type_suggestions">
                    <option value="Optreden">
                    <option value="Terras">
                    <option value="Repetitie">
                </datalist>
                <br>
                <button type="submit" id="saveButton">Opslaan</button>
                <button type="button" onclick="printList()">Print lijst</button>
            </div>
            <div class="column-item">
                <p>Onze nummers:</p><br>
                <select class="myChoices" id="mySelect" multiple="multiple" name="lijst_nummernaam" style="background-color: grey; color: black; width: 220px; height: 400px; overflow-x: hidden; overflow-y: auto">
                    <% for (let nummer of nummers) { %>
                        <option value="<%= nummer.nr_naam %>" style="background-color: grey; color: black;" >
                            <%= nummer.nr_naam %>
                        </option>
                            <%= nummer.nr_naam %></option>
                    <% } %>
                </select>
            </div>
        </div>
    </form>

    <script>
        $(document).ready(function() {
            // Initialize Choices.js
            const element = document.getElementById('lijst_nummernaam');
const choices = new Choices(element, {
  removeItemButton: true,
  shouldSort: false
});

            // Make the selected items draggable
           $('.choices__list--multiple').sortable({
  update: function(event, ui) {
    const newOrder = $(this).children().map(function() {
      return $(this).data('value');
    }).get();

    const activeItems = choices._store.activeItems;
    const reorderedItems = newOrder.map(value => {
      return activeItems.find(item => item.value === value);
    });

    choices.setChoices(reorderedItems.map(item => ({
      value: item.value,
      label: item.label,
      selected: true
    })), 'value', 'label', true);
  }
});

            // Form submission handler
            $('#saveButton').on('click', function(event) {
                event.preventDefault(); // Prevent default form submission

                const form = document.getElementById('myForm');
                const formData = new FormData(form);
                const data = {};

                formData.forEach((value, key) => {
                    data[key] = value;
                });

                const selectedValues = $('#lijst_nummernaam').val();
                data['lijst_nummernaam'] = selectedValues;

                fetch('/save-values', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Success:', data);
                    alert('Save successful!'); // Display success message
                })
                .catch((error) => {
                    console.error('Error:', error);
                    alert('Save failed!'); // Display error message
                });
            });
        });

        // Print list function
        function printList() {
            // Get the values of lijst_naam and lijst_type
            const lijstNaam = document.getElementById('lijst_naam').value;
            const lijstType = document.getElementById('lijst_type').value;

            // Get the selected values from myChoices select element
            const selectedValues = Array.from(document.querySelectorAll('#lijst_nummernaam option:checked')).map(option => option.value);

            // Create a new window for printing
            const printWindow = window.open('', '_blank');

            // Set the title of the print window
            printWindow.document.title = lijstNaam;

            // Generate the HTML content to be printed
            const htmlContent = `
                <html>
                <head>
                    <title>${lijstNaam}</title>
                </head>
                <body>
                    <h1>${lijstNaam}</h1>
                    <p>Lijst type: ${lijstType}</p>
                    <ul>
                        ${selectedValues.map(value => `<li>${value}</li>`).join('')}
                    </ul>
                </body>
                </html>
            `;

            // Set the HTML content of the print window
            printWindow.document.write(htmlContent);

            // Ensure the content is fully loaded before printing
            printWindow.document.close();
            printWindow.focus();
            printWindow.onload = function() {
                printWindow.print();
                printWindow.close();
            };
        }
    </script>
    
<script>
$(document).ready(function() {
    // Make the select options sortable
    $("#mySelect").sortable();

    // Add a double click event to remove items
    $("#mySelect option").dblclick(function() {
        $(this).remove();
    });
});
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.13.0/Sortable.min.js"></script>
	<script>
		new Sortable(example1, {
			animation: 150
		});

		new Sortable(example2Left, {
			group: 'shared',
			animation: 150
		});

		new Sortable(example2Right, {
			group: 'shared',
			animation: 150
		});
	</script>
</body>

</html>
